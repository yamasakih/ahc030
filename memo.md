## ルール
- 複数の油田が重なるとそのマスの油田量は値は１ずつ増える
- 占いのコストは小数になることもある
- 占いは正方形や長方形でなくても良い
- マスは (0, 0) スタート (縦, 横) を表す

## アイディア
- ✓ 最初に何回か全体を覆うように占ってオイルの総量を求めるとよさそう → eps は最初に与えられてたので必要ない作業だった
- ✓ 正方形をスライドするように占うと確率を重ねたようになるかも -> 正方形じゃなくて油田の形に占うほうが良さそう
- ✓ 失敗してもコストが１増えるだけだからある程度決まったら `a` をしてもいいかも
- ✓ 場所がほぼ確定した場合、掘るかわりにその領域をまとめて占ってもよい
- ✓ 油田の形に占うほうが良さそう -> ケースバイケースぽい
- ✓ 制限時間３秒までどう時間を利用するか。占い場ある程度進んだ段階でありえる油田の配置を計算するとか？ -> M が少ない時は全探索に計算時間を使っても良さそう
- 次どこを占う＆掘るかをベイズ推定やActive Learningでできたらおもしろそう
- eps の値で戦術を場合分けしたほうがよさそう
- 0 と予想されたマスは占いの候補に入れる必要がなさそう
- 平均がだんだん小さく占われていくから eps の値によって変化する補正があってもよさそう
- 占う範囲が広すぎると薄まった感じになってあまり良くなさそう
- 油田がある確率が高そうなものをソートするために multiset で管理をする
- multiset からデータを取り出す時に単純に確率が高いものを取り出すのではなくて焼きなまし的にたまに確率が低いものを取り出すのも良さそう
- 油田の形に占う時面積の大きさを加味する？
- 一旦、 greedy ぽく最初に適当に占い確率の高いところを掘る -> 油田を見つけたらそこから四方に確率の高いところを優先的に掘るというのをやってみる -> 他のアイディアを優先するために一旦 pending
- ある程度繋げて掘れたらこの部分を持つ油田をフィルターするとできたら良さそう
- 占うときはランダムな繋がっている図形を使うと良さそう
- 角のここが 0 なら逆に嬉しいみたいな点を掘るのもよさそう
- 端から攻めていく。このポイントが 0 だったら全ての図形がこの端には存在しないという点を決めて掘っていく
- ✓ M が少ないなら全探索で全ての考えられる配置を考えるなどもできそう
- AHC30 側でもサーバと同じことをやって確率分布を求めて近似なものがから攻めるとかできそう -> 現在の形に似ているかいないかで１軍と２軍に分ける。１軍の中で二分探索ぽくふるい落としができるようなところを掘ったり占う。占いのパーツは部分構造にできたら尚良し
- 全探索できない場合は山登り法などで探索する
- 単純なランダムだといったりきたりになるからスムースなランダムを使う
- 正方形タイプ、横長長方形タイプ、縦長長方形タイプと、油田がおけるエリアと油田を分けると良さそう
- ビットで現在の様子を保存すると良さそう
- Rust の公式のコードと judge に差がないか確認する -> gauss 分布を使わないようにしたけど使うときと差が出るか確認する
- グラフコンボリューションで確率分布をスムースにしたほうが良くなったりするかも
- logger をいい感じに使えば良さそう
- 実は独立して場所のサーチができたりしない？

## shell script
### test case すべてに実行する場合
seq -f "%04g" 0 99 | xargs -I{} -P 8 bash -c 'oj t/r "./judge.py tests/in/$1.txt" -c "pypy main.py" &> "tests/out/trial009/$1.log"' _ {}

### log から末尾を取り出す場合
X=00X; for i in {0000..0099}; do tail -n 1 "tests/out/trial${X}/$i.log"; done > "tests/out/trial${X}/check.log"

### log からコストをまとめて取り出す場合
X=00X; for i in {0000..0099}; do tail -n 3 "tests/out/trial${X}/$i.log" | head -n 1 | cut -c 23- ; done > "tests/out/trial${X}/summary.log"

### summary.log の値を全部足し算する場合
X=00X; awk '{sum += $1} END {print sum}' "tests/out/trial${X}/summary.log"

## Trial
### Trial000 (20597, 12696000000)
Sample submission -> 12696000000

### Trial001
- 10,000 回ぐらい大きさ、場所をランダムに矩形を作って占ってみたけどコストが１つずつ掘るより10倍高い 2200 であり、全然場所が特定できてなかった -> 矩形の幅を小さくしてみる

### Trial002
- 10,000 回ぐらい大きさを小さくするために辺の長さを 2 - 5、場所をランダムに矩形を作って占ってみたけど引き続きコストが１つずつ掘るより10倍高い 2200 であり、全然場所が特定できてなかった -> ある程度占って当たりをつけたら掘るというのを行ったほうが良さそう

### Trial003 (17680, 12105000000)
- N と M が小さい時は油田の配置を全探索するようにした。それ以外の時は sample submission と同様。確率の低いところから 0 で詰めていき考えられるパターンが１通りになったら終わる。 -> 12105000000

### Trial004 (15959, 11057000000)
- とりあえずで Sample submission の play_all_dig は油田がもうなくても掘り続けるので総油田量分発見したらもう掘らないようにした。

### Trial005 (15277, TLE)
- M <= 3 の時、全探索ですべての油田の配置からなる重なり合わせた油田を作り、その油田から AHC30 自身が 1000 回占いを行うことで得られる平均の確率分布が、Judge に占ってもらった結果と似ているか距離を計算する。その距離が近いものから順に a の query で提出していく。 -> 計算はできたが計算が明らかに 6 秒以上かかっている時があった。 ->

### Trial006 (15220, TLE)
- Trial005 に加えて M > 3 なら 2 個間隔で最初に掘るようにした -> TLE

### Trial007 (15770.2, 10947738764)
- Trial006 より play_brute_force に行くときの条件を厳しくした

### Trial008 (15741.1, 10941855645)
- Trial007 より eps が小さい値の play_brute_force をする時、一度に占う面積を大きくした

### Trial009 (15639.1, 10912855645)
- 単純に掘ってるだけのものを絶対存在しないところを先に調べてそこは掘らないようにした

## ChatGPT
現在、競技プログラミングのコンテストに参加しています。以下にコンテストの問題のデータ作成方法を示しますので、そちらを理解した後に私からの追加の質問に答えてください。

- ChatGPT を用いてパラメータの解析を行う
cf. https://chat.openai.com/c/adc034f0-549d-4462-8923-54254be26c51
